---
// Data Pipeline Section - Real-time and Batch processing views
---

<section id="pipeline" class="pipeline-section">
    <!-- Premium Header -->
    <div class="pipeline-hero-header" data-aos="fade-up">
        <div class="pipeline-title-wrap">
            <div class="pipeline-icon-glow">
                <i class="fas fa-project-diagram"></i>
            </div>
            <div class="pipeline-title-content">
                <h2 class="pipeline-main-title">Data Pipeline <span class="gradient-text">End-to-End</span></h2>
                <p class="pipeline-tagline">Arquitectura moderna de flujo de datos en tiempo real y batch</p>
            </div>
        </div>
        <!-- Mode Selector Buttons -->
        <div class="pipeline-mode-selector">
            <button class="mode-btn active" data-mode="realtime" id="btn-realtime">
                <i class="fas fa-bolt"></i>
                <span>Real-time Streaming</span>
                <small>Latencia &lt; 1s</small>
            </button>
            <button class="mode-btn" data-mode="batch" id="btn-batch">
                <i class="fas fa-layer-group"></i>
                <span>Batch Processing</span>
                <small>Alto volumen</small>
            </button>
            <button class="mode-btn" data-mode="architecture" id="btn-architecture">
                <i class="fas fa-stream"></i>
                <span>Pipeline Architecture</span>
                <small>E2E Diagram</small>
            </button>
            <button class="mode-btn" data-mode="governance" id="btn-governance">
                <i class="fas fa-shield-alt"></i>
                <span>Data Governance</span>
                <small>Framework</small>
            </button>
        </div>
    </div>

    <!-- Pipeline Diagrams Container -->
    <div class="pipeline-container" data-aos="fade-up" data-aos-delay="100">

        <!-- ==================== REAL-TIME STREAMING PIPELINE ==================== -->
        <div id="pipeline-realtime" class="pipeline-diagram-premium pipeline-mode active">
            <!-- Pipeline Header -->
            <div class="pipeline-mode-header realtime">
                <div class="mode-indicator">
                    <i class="fas fa-bolt"></i>
                    <span>Real-time Streaming Pipeline</span>
                </div>
                <div class="mode-stats">
                    <span class="stat-pill"><i class="fas fa-clock"></i> Latencia: &lt;1s</span>
                    <span class="stat-pill"><i class="fas fa-tachometer-alt"></i> 100K+ events/s</span>
                    <span class="stat-pill"><i class="fas fa-sync"></i> 24/7 Continuous</span>
                </div>
            </div>

            <!-- Animated Connection Line -->
            <div class="pipeline-connection-line realtime-line">
                <div class="data-flow-animation fast"></div>
            </div>

            <!-- Pipeline Stages -->
            <div class="pipeline-stages-grid">
                <!-- Stage 1: Ingest -->
                <div class="pipeline-stage-card">
                    <div class="stage-number">01</div>
                    <div class="stage-icon-premium extract">
                        <i class="fas fa-satellite-dish"></i>
                    </div>
                    <div class="stage-content">
                        <h4 class="stage-title">Ingest</h4>
                        <p class="stage-desc">Event Streaming</p>
                    </div>
                    <div class="stage-tech-stack">
                        <a href="https://kafka.apache.org/" target="_blank" class="tech-mini"><i class="devicon-apachekafka-original"></i> Kafka</a>
                        <a href="https://aws.amazon.com/kinesis/" target="_blank" class="tech-mini"><i class="devicon-amazonwebservices-plain-wordmark"></i> Kinesis</a>
                        <a href="https://pulsar.apache.org/" target="_blank" class="tech-mini"><i class="fas fa-meteor"></i> Pulsar</a>
                        <a href="https://www.rabbitmq.com/" target="_blank" class="tech-mini"><i class="fas fa-rabbit"></i> RabbitMQ</a>
                    </div>
                </div>
                <div class="stage-arrow"><i class="fas fa-arrow-right"></i></div>

                <!-- Stage 2: Process -->
                <div class="pipeline-stage-card">
                    <div class="stage-number">02</div>
                    <div class="stage-icon-premium transform">
                        <i class="fas fa-bolt"></i>
                    </div>
                    <div class="stage-content">
                        <h4 class="stage-title">Process</h4>
                        <p class="stage-desc">Stream Processing</p>
                    </div>
                    <div class="stage-tech-stack">
                        <a href="https://flink.apache.org/" target="_blank" class="tech-mini"><i class="fas fa-water"></i> Flink</a>
                        <a href="https://spark.apache.org/streaming/" target="_blank" class="tech-mini"><i class="devicon-apachespark-original colored"></i> Spark</a>
                        <a href="https://kafka.apache.org/documentation/streams/" target="_blank" class="tech-mini"><i class="devicon-apachekafka-original"></i> Streams</a>
                        <a href="https://storm.apache.org/" target="_blank" class="tech-mini"><i class="fas fa-wind"></i> Storm</a>
                    </div>
                </div>
                <div class="stage-arrow"><i class="fas fa-arrow-right"></i></div>

                <!-- Stage 3: Store -->
                <div class="pipeline-stage-card">
                    <div class="stage-number">03</div>
                    <div class="stage-icon-premium load">
                        <i class="fas fa-database"></i>
                    </div>
                    <div class="stage-content">
                        <h4 class="stage-title">Store</h4>
                        <p class="stage-desc">Real-time Storage</p>
                    </div>
                    <div class="stage-tech-stack">
                        <a href="https://redis.io/" target="_blank" class="tech-mini"><i class="devicon-redis-plain colored"></i> Redis</a>
                        <a href="https://www.elastic.co/" target="_blank" class="tech-mini"><i class="devicon-elasticsearch-plain colored"></i> Elastic</a>
                        <a href="https://cassandra.apache.org/" target="_blank" class="tech-mini"><i class="fas fa-eye"></i> Cassandra</a>
                        <a href="https://clickhouse.com/" target="_blank" class="tech-mini"><i class="fas fa-mouse-pointer"></i> ClickHouse</a>
                    </div>
                </div>
                <div class="stage-arrow"><i class="fas fa-arrow-right"></i></div>

                <!-- Stage 4: Serve -->
                <div class="pipeline-stage-card">
                    <div class="stage-number">04</div>
                    <div class="stage-icon-premium serve">
                        <i class="fas fa-desktop"></i>
                    </div>
                    <div class="stage-content">
                        <h4 class="stage-title">Serve</h4>
                        <p class="stage-desc">Real-time Dashboards</p>
                    </div>
                    <div class="stage-tech-stack">
                        <a href="https://grafana.com/" target="_blank" class="tech-mini"><i class="devicon-grafana-original colored"></i> Grafana</a>
                        <a href="https://www.elastic.co/kibana" target="_blank" class="tech-mini"><i class="fas fa-chart-line"></i> Kibana</a>
                        <a href="https://superset.apache.org/" target="_blank" class="tech-mini"><i class="fas fa-tachometer-alt"></i> Superset</a>
                        <a href="https://socket.io/" target="_blank" class="tech-mini"><i class="fas fa-plug"></i> WebSockets</a>
                    </div>
                </div>
            </div>

            <!-- Orchestration Layer for Real-time -->
            <div class="pipeline-layers">
                <div class="layer-card orchestration">
                    <div class="layer-icon"><i class="fas fa-network-wired"></i></div>
                    <div class="layer-info">
                        <span class="layer-label">EVENT BROKER</span>
                        <span class="layer-name">Apache Kafka</span>
                    </div>
                    <div class="layer-status running">
                        <span class="status-indicator"></span>
                        <span>Streaming</span>
                    </div>
                    <div class="layer-extras">
                        <span class="extra-badge"><i class="fas fa-server"></i> 12 Brokers</span>
                        <span class="extra-badge"><i class="fas fa-layer-group"></i> 50 Topics</span>
                    </div>
                </div>
                <div class="layer-card quality">
                    <div class="layer-icon"><i class="fas fa-shield-alt"></i></div>
                    <div class="layer-info">
                        <span class="layer-label">SCHEMA REGISTRY</span>
                        <span class="layer-name">Confluent</span>
                    </div>
                    <div class="layer-status healthy">
                        <span class="status-indicator"></span>
                        <span>Validating</span>
                    </div>
                    <div class="layer-extras">
                        <span class="extra-badge"><i class="fas fa-file-code"></i> Avro/Proto</span>
                        <span class="extra-badge"><i class="fas fa-history"></i> Versioned</span>
                    </div>
                </div>
                <div class="layer-card observability">
                    <div class="layer-icon"><i class="fas fa-heartbeat"></i></div>
                    <div class="layer-info">
                        <span class="layer-label">MONITORING</span>
                        <span class="layer-name">Prometheus + Grafana</span>
                    </div>
                    <div class="layer-status monitoring">
                        <span class="status-indicator"></span>
                        <span>Live Metrics</span>
                    </div>
                    <div class="layer-extras">
                        <span class="extra-badge"><i class="fas fa-bell"></i> Alerting</span>
                        <span class="extra-badge"><i class="fas fa-chart-area"></i> Dashboards</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- ==================== BATCH PROCESSING PIPELINE ==================== -->
        <div id="pipeline-batch" class="pipeline-diagram-premium pipeline-mode">
            <!-- Pipeline Header -->
            <div class="pipeline-mode-header batch">
                <div class="mode-indicator">
                    <i class="fas fa-layer-group"></i>
                    <span>Batch Processing Pipeline</span>
                </div>
                <div class="mode-stats">
                    <span class="stat-pill"><i class="fas fa-database"></i> Petabytes</span>
                    <span class="stat-pill"><i class="fas fa-calendar-alt"></i> Daily/Hourly</span>
                    <span class="stat-pill"><i class="fas fa-check-double"></i> ACID Compliant</span>
                </div>
            </div>

            <!-- Animated Connection Line -->
            <div class="pipeline-connection-line batch-line">
                <div class="data-flow-animation"></div>
            </div>

            <!-- Pipeline Stages -->
            <div class="pipeline-stages-grid">
                <!-- Stage 1: Extract -->
                <div class="pipeline-stage-card">
                    <div class="stage-number">01</div>
                    <div class="stage-icon-premium extract">
                        <i class="fas fa-file-import"></i>
                    </div>
                    <div class="stage-content">
                        <h4 class="stage-title">Extract</h4>
                        <p class="stage-desc">Data Sources</p>
                    </div>
                    <div class="stage-tech-stack">
                        <a href="https://www.postgresql.org/" target="_blank" class="tech-mini"><i class="devicon-postgresql-plain colored"></i> PostgreSQL</a>
                        <a href="https://aws.amazon.com/s3/" target="_blank" class="tech-mini"><i class="devicon-amazonwebservices-plain-wordmark"></i> S3/GCS</a>
                        <a href="https://www.snowflake.com/" target="_blank" class="tech-mini"><i class="fas fa-snowflake"></i> APIs</a>
                        <a href="https://www.fivetran.com/" target="_blank" class="tech-mini"><i class="fas fa-plug"></i> Fivetran</a>
                    </div>
                </div>
                <div class="stage-arrow"><i class="fas fa-arrow-right"></i></div>

                <!-- Stage 2: Transform -->
                <div class="pipeline-stage-card">
                    <div class="stage-number">02</div>
                    <div class="stage-icon-premium transform">
                        <i class="fas fa-cogs"></i>
                    </div>
                    <div class="stage-content">
                        <h4 class="stage-title">Transform</h4>
                        <p class="stage-desc">ETL / ELT</p>
                    </div>
                    <div class="stage-tech-stack">
                        <a href="https://spark.apache.org/" target="_blank" class="tech-mini"><i class="devicon-apachespark-original colored"></i> Spark</a>
                        <a href="https://www.getdbt.com/" target="_blank" class="tech-mini"><i class="fas fa-code-branch"></i> dbt</a>
                        <a href="https://www.python.org/" target="_blank" class="tech-mini"><i class="devicon-python-plain colored"></i> Python</a>
                        <a href="https://pandas.pydata.org/" target="_blank" class="tech-mini"><i class="fas fa-table"></i> Pandas</a>
                    </div>
                </div>
                <div class="stage-arrow"><i class="fas fa-arrow-right"></i></div>

                <!-- Stage 3: Load -->
                <div class="pipeline-stage-card">
                    <div class="stage-number">03</div>
                    <div class="stage-icon-premium load">
                        <i class="fas fa-warehouse"></i>
                    </div>
                    <div class="stage-content">
                        <h4 class="stage-title">Load</h4>
                        <p class="stage-desc">Data Warehouse</p>
                    </div>
                    <div class="stage-tech-stack">
                        <a href="https://www.snowflake.com/" target="_blank" class="tech-mini"><i class="fas fa-snowflake"></i> Snowflake</a>
                        <a href="https://www.databricks.com/" target="_blank" class="tech-mini"><i class="fas fa-cubes"></i> Databricks</a>
                        <a href="https://cloud.google.com/bigquery" target="_blank" class="tech-mini"><i class="devicon-googlecloud-plain colored"></i> BigQuery</a>
                        <a href="https://aws.amazon.com/redshift/" target="_blank" class="tech-mini"><i class="devicon-amazonwebservices-plain-wordmark"></i> Redshift</a>
                    </div>
                </div>
                <div class="stage-arrow"><i class="fas fa-arrow-right"></i></div>

                <!-- Stage 4: Analyze -->
                <div class="pipeline-stage-card">
                    <div class="stage-number">04</div>
                    <div class="stage-icon-premium serve">
                        <i class="fas fa-chart-pie"></i>
                    </div>
                    <div class="stage-content">
                        <h4 class="stage-title">Analyze</h4>
                        <p class="stage-desc">BI & Analytics</p>
                    </div>
                    <div class="stage-tech-stack">
                        <a href="https://powerbi.microsoft.com/" target="_blank" class="tech-mini"><i class="fas fa-chart-pie"></i> Power BI</a>
                        <a href="https://www.tableau.com/" target="_blank" class="tech-mini"><i class="fas fa-chart-area"></i> Tableau</a>
                        <a href="https://looker.com/" target="_blank" class="tech-mini"><i class="fas fa-eye"></i> Looker</a>
                        <a href="https://metabase.com/" target="_blank" class="tech-mini"><i class="fas fa-chart-bar"></i> Metabase</a>
                    </div>
                </div>
            </div>

            <!-- Orchestration Layer for Batch -->
            <div class="pipeline-layers">
                <div class="layer-card orchestration">
                    <div class="layer-icon"><i class="devicon-apacheairflow-plain"></i></div>
                    <div class="layer-info">
                        <span class="layer-label">ORCHESTRATION</span>
                        <span class="layer-name">Apache Airflow</span>
                    </div>
                    <div class="layer-status running">
                        <span class="status-indicator"></span>
                        <span>DAG Active</span>
                    </div>
                    <div class="layer-extras">
                        <span class="extra-badge"><i class="fas fa-clock"></i> Cron: 0 6 * * *</span>
                        <span class="extra-badge"><i class="fas fa-redo"></i> Retries: 3</span>
                    </div>
                </div>
                <div class="layer-card quality">
                    <div class="layer-icon"><i class="fas fa-shield-alt"></i></div>
                    <div class="layer-info">
                        <span class="layer-label">DATA QUALITY</span>
                        <span class="layer-name">Great Expectations</span>
                    </div>
                    <div class="layer-status healthy">
                        <span class="status-indicator"></span>
                        <span>Tests Passing</span>
                    </div>
                    <div class="layer-extras">
                        <span class="extra-badge"><i class="fas fa-check-circle"></i> 47 Expectations</span>
                        <span class="extra-badge"><i class="fas fa-percentage"></i> 99.8% Pass</span>
                    </div>
                </div>
                <div class="layer-card observability">
                    <div class="layer-icon"><i class="fas fa-eye"></i></div>
                    <div class="layer-info">
                        <span class="layer-label">DATA CATALOG</span>
                        <span class="layer-name">DataHub / Atlan</span>
                    </div>
                    <div class="layer-status monitoring">
                        <span class="status-indicator"></span>
                        <span>Cataloging</span>
                    </div>
                    <div class="layer-extras">
                        <span class="extra-badge"><i class="fas fa-table"></i> 156 Tables</span>
                        <span class="extra-badge"><i class="fas fa-sitemap"></i> Lineage</span>
                    </div>
                </div>
            </div>

            <!-- Airflow DAG Code -->
            <div class="dag-code-container glass-card">
                <div class="code-header">
                    <div class="code-file">
                        <i class="devicon-python-plain colored"></i>
                        <span>etl_dag.py</span>
                    </div>
                    <div class="code-badges">
                        <span class="code-badge airflow"><i class="devicon-apacheairflow-plain"></i> Airflow 2.x</span>
                        <span class="code-badge python"><i class="devicon-python-plain"></i> Python 3.11</span>
                    </div>
                </div>
                <div class="code-block">
                    <pre><code class="language-python"><span class="code-comment"># etl_dag.py - Pipeline de datos completo</span>
<span class="code-keyword">from</span> airflow <span class="code-keyword">import</span> DAG
<span class="code-keyword">from</span> airflow.operators.python <span class="code-keyword">import</span> PythonOperator
<span class="code-keyword">from</span> airflow.providers.postgres.operators.postgres <span class="code-keyword">import</span> PostgresOperator
<span class="code-keyword">from</span> datetime <span class="code-keyword">import</span> datetime, timedelta

<span class="code-comment"># Configuraci√≥n del DAG</span>
default_args = &#123;
    <span class="code-string">'owner'</span>: <span class="code-string">'data-team'</span>,
    <span class="code-string">'depends_on_past'</span>: <span class="code-keyword">False</span>,
    <span class="code-string">'start_date'</span>: datetime(<span class="code-number">2025</span>, <span class="code-number">1</span>, <span class="code-number">1</span>),
    <span class="code-string">'retries'</span>: <span class="code-number">3</span>,
    <span class="code-string">'retry_delay'</span>: timedelta(minutes=<span class="code-number">5</span>),
&#125;

<span class="code-keyword">with</span> DAG(
    <span class="code-string">'etl_pipeline_prod'</span>,
    default_args=default_args,
    schedule_interval=<span class="code-string">'0 6 * * *'</span>,  <span class="code-comment"># Diario a las 6 AM</span>
    catchup=<span class="code-keyword">False</span>,
    tags=[<span class="code-string">'etl'</span>, <span class="code-string">'production'</span>]
) <span class="code-keyword">as</span> dag:

    <span class="code-comment"># Task 1: Extraer datos desde API</span>
    extract = PythonOperator(
        task_id=<span class="code-string">'extract_from_api'</span>,
        python_callable=extract_data
    )

    <span class="code-comment"># Task 2: Transformar con Spark</span>
    transform = PythonOperator(
        task_id=<span class="code-string">'transform_spark'</span>,
        python_callable=spark_transform
    )

    <span class="code-comment"># Task 3: Cargar a Data Warehouse</span>
    load = PostgresOperator(
        task_id=<span class="code-string">'load_to_warehouse'</span>,
        postgres_conn_id=<span class="code-string">'warehouse_conn'</span>,
        sql=<span class="code-string">'sql/load_facts.sql'</span>
    )

    <span class="code-comment"># Definir dependencias</span>
    extract >> transform >> load</code></pre>
                </div>
                <div class="code-footer">
                    <span class="code-meta"><i class="fas fa-clock"></i> Schedule: Daily 6:00 AM</span>
                    <span class="code-meta"><i class="fas fa-tags"></i> Tags: etl, production</span>
                </div>
            </div>
        </div>

        <!-- ==================== ARCHITECTURE DIAGRAM ==================== -->
        <div id="pipeline-architecture" class="pipeline-diagram-premium pipeline-mode">
            <!-- Premium Architecture Diagram -->
            <div class="arch-diagram-premium glass-card">
                <!-- Header with Live Status -->
                <div class="arch-premium-header">
                    <div class="arch-title-section">
                        <div class="arch-icon-animated">
                            <i class="fas fa-project-diagram"></i>
                            <div class="pulse-ring"></div>
                        </div>
                        <div class="arch-title-text">
                            <h3>Modern Data Platform Architecture</h3>
                            <span class="arch-subtitle">Enterprise-Grade End-to-End Data Flow</span>
                        </div>
                    </div>
                    <div class="arch-live-status">
                        <div class="live-indicator">
                            <span class="live-dot"></span>
                            <span>LIVE</span>
                        </div>
                        <div class="arch-metrics-mini">
                            <span><i class="fas fa-tachometer-alt"></i> 2.4M events/min</span>
                            <span><i class="fas fa-clock"></i> 99.9% uptime</span>
                        </div>
                    </div>
                </div>

                <!-- Main Architecture Flow -->
                <div class="arch-flow-container">
                    <!-- Layer 1: Data Sources -->
                    <div class="arch-layer sources">
                        <div class="layer-header-premium">
                            <div class="layer-number">01</div>
                            <div class="layer-title">
                                <i class="fas fa-database"></i>
                                <span>DATA SOURCES</span>
                            </div>
                            <div class="layer-throughput">
                                <i class="fas fa-arrow-up"></i> 500K/s
                            </div>
                        </div>
                        <div class="source-cards-grid">
                            <a href="https://www.salesforce.com/" target="_blank" class="source-card-premium saas">
                                <div class="source-icon"><i class="fab fa-salesforce"></i></div>
                                <div class="source-info">
                                    <span class="source-name">SaaS Apps</span>
                                    <span class="source-detail">Salesforce, HubSpot</span>
                                </div>
                                <div class="source-rate">12K/min</div>
                            </a>
                            <a href="https://www.postgresql.org/" target="_blank" class="source-card-premium oltp">
                                <div class="source-icon"><i class="devicon-postgresql-plain colored"></i></div>
                                <div class="source-info">
                                    <span class="source-name">OLTP DBs</span>
                                    <span class="source-detail">PostgreSQL, MySQL</span>
                                </div>
                                <div class="source-rate">45K/min</div>
                            </a>
                            <a href="https://kafka.apache.org/" target="_blank" class="source-card-premium events">
                                <div class="source-icon"><i class="devicon-apachekafka-original"></i></div>
                                <div class="source-info">
                                    <span class="source-name">Event Streams</span>
                                    <span class="source-detail">Kafka, Kinesis</span>
                                </div>
                                <div class="source-rate">2.1M/min</div>
                            </a>
                            <a href="https://aws.amazon.com/s3/" target="_blank" class="source-card-premium files">
                                <div class="source-icon"><i class="fas fa-file-alt"></i></div>
                                <div class="source-info">
                                    <span class="source-name">File Storage</span>
                                    <span class="source-detail">S3, GCS, ADLS</span>
                                </div>
                                <div class="source-rate">8TB/day</div>
                            </a>
                        </div>
                    </div>

                    <!-- Animated Flow Line -->
                    <div class="flow-connector-premium">
                        <div class="flow-line-animated"></div>
                        <div class="flow-label-badge">
                            <i class="fas fa-arrow-down"></i>
                            <span>INGESTION</span>
                        </div>
                    </div>

                    <!-- Layer 2: Ingestion -->
                    <div class="arch-layer ingestion">
                        <div class="layer-header-premium">
                            <div class="layer-number">02</div>
                            <div class="layer-title">
                                <i class="fas fa-download"></i>
                                <span>INGESTION LAYER</span>
                            </div>
                        </div>
                        <div class="ingestion-tools-premium">
                            <a href="https://kafka.apache.org/" target="_blank" class="ingestion-tool streaming">
                                <div class="tool-icon-wrap"><i class="devicon-apachekafka-original"></i></div>
                                <div class="tool-name">Kafka Connect</div>
                                <div class="tool-type">Streaming</div>
                                <div class="tool-latency"><i class="fas fa-bolt"></i> &lt;10ms</div>
                            </a>
                            <a href="https://www.fivetran.com/" target="_blank" class="ingestion-tool batch">
                                <div class="tool-icon-wrap"><i class="fas fa-plug"></i></div>
                                <div class="tool-name">Fivetran</div>
                                <div class="tool-type">CDC/Batch</div>
                                <div class="tool-latency"><i class="fas fa-clock"></i> 5min</div>
                            </a>
                            <a href="https://airbyte.com/" target="_blank" class="ingestion-tool hybrid">
                                <div class="tool-icon-wrap"><i class="fas fa-sync-alt"></i></div>
                                <div class="tool-name">Airbyte</div>
                                <div class="tool-type">EL Tool</div>
                                <div class="tool-latency"><i class="fas fa-clock"></i> Custom</div>
                            </a>
                        </div>
                    </div>

                    <!-- Animated Flow Line -->
                    <div class="flow-connector-premium">
                        <div class="flow-line-animated delay-1"></div>
                        <div class="flow-label-badge">
                            <i class="fas fa-arrow-down"></i>
                            <span>RAW DATA</span>
                        </div>
                    </div>

                    <!-- Layer 3: Lakehouse -->
                    <div class="arch-layer lakehouse">
                        <div class="layer-header-premium">
                            <div class="layer-number">03</div>
                            <div class="layer-title">
                                <i class="fas fa-water"></i>
                                <span>LAKEHOUSE</span>
                            </div>
                            <div class="layer-storage">
                                <i class="fas fa-hdd"></i> 45 PB
                            </div>
                        </div>
                        <div class="medallion-architecture">
                            <div class="medallion-zone bronze">
                                <div class="zone-glow"></div>
                                <div class="zone-content">
                                    <div class="zone-icon"><i class="fas fa-file-import"></i></div>
                                    <div class="zone-label">BRONZE</div>
                                    <div class="zone-desc">Raw Landing</div>
                                    <div class="zone-stats">
                                        <span><i class="fas fa-table"></i> 1,240</span>
                                        <span><i class="fas fa-database"></i> 12TB</span>
                                    </div>
                                </div>
                            </div>
                            <div class="zone-flow">
                                <div class="flow-particles">
                                    <span></span><span></span><span></span>
                                </div>
                                <i class="fas fa-chevron-right"></i>
                            </div>
                            <div class="medallion-zone silver">
                                <div class="zone-glow"></div>
                                <div class="zone-content">
                                    <div class="zone-icon"><i class="fas fa-broom"></i></div>
                                    <div class="zone-label">SILVER</div>
                                    <div class="zone-desc">Cleaned & Validated</div>
                                    <div class="zone-stats">
                                        <span><i class="fas fa-table"></i> 890</span>
                                        <span><i class="fas fa-database"></i> 8TB</span>
                                    </div>
                                </div>
                            </div>
                            <div class="zone-flow">
                                <div class="flow-particles">
                                    <span></span><span></span><span></span>
                                </div>
                                <i class="fas fa-chevron-right"></i>
                            </div>
                            <div class="medallion-zone gold">
                                <div class="zone-glow"></div>
                                <div class="zone-content">
                                    <div class="zone-icon"><i class="fas fa-gem"></i></div>
                                    <div class="zone-label">GOLD</div>
                                    <div class="zone-desc">Business Ready</div>
                                    <div class="zone-stats">
                                        <span><i class="fas fa-table"></i> 156</span>
                                        <span><i class="fas fa-database"></i> 2TB</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="lakehouse-tech-row">
                            <a href="https://delta.io/" target="_blank" class="lake-tech-chip"><i class="fas fa-layer-group"></i> Delta Lake</a>
                            <a href="https://iceberg.apache.org/" target="_blank" class="lake-tech-chip"><i class="fas fa-cubes"></i> Iceberg</a>
                            <a href="https://aws.amazon.com/s3/" target="_blank" class="lake-tech-chip"><i class="devicon-amazonwebservices-plain-wordmark"></i> S3</a>
                            <a href="https://hudi.apache.org/" target="_blank" class="lake-tech-chip"><i class="fas fa-bolt"></i> Hudi</a>
                        </div>
                    </div>

                    <!-- Animated Flow Line -->
                    <div class="flow-connector-premium">
                        <div class="flow-line-animated delay-2"></div>
                        <div class="flow-label-badge">
                            <i class="fas fa-arrow-down"></i>
                            <span>TRANSFORM</span>
                        </div>
                    </div>

                    <!-- Layer 4: Processing -->
                    <div class="arch-layer processing">
                        <div class="layer-header-premium">
                            <div class="layer-number">04</div>
                            <div class="layer-title">
                                <i class="fas fa-cogs"></i>
                                <span>PROCESSING</span>
                            </div>
                        </div>
                        <div class="processing-engines-premium">
                            <a href="https://spark.apache.org/" target="_blank" class="engine-card-premium">
                                <div class="engine-icon"><i class="devicon-apachespark-original colored"></i></div>
                                <div class="engine-name">Apache Spark</div>
                                <div class="engine-use">Distributed ETL</div>
                                <div class="engine-metric"><i class="fas fa-microchip"></i> 500 cores</div>
                            </a>
                            <a href="https://www.getdbt.com/" target="_blank" class="engine-card-premium">
                                <div class="engine-icon"><i class="fas fa-code-branch"></i></div>
                                <div class="engine-name">dbt Core</div>
                                <div class="engine-use">SQL Transforms</div>
                                <div class="engine-metric"><i class="fas fa-cube"></i> 340 models</div>
                            </a>
                            <a href="https://flink.apache.org/" target="_blank" class="engine-card-premium">
                                <div class="engine-icon"><i class="fas fa-water"></i></div>
                                <div class="engine-name">Apache Flink</div>
                                <div class="engine-use">Stream Processing</div>
                                <div class="engine-metric"><i class="fas fa-bolt"></i> Real-time</div>
                            </a>
                        </div>
                    </div>

                    <!-- Animated Flow Line -->
                    <div class="flow-connector-premium">
                        <div class="flow-line-animated delay-3"></div>
                        <div class="flow-label-badge">
                            <i class="fas fa-arrow-down"></i>
                            <span>SERVE</span>
                        </div>
                    </div>

                    <!-- Layer 5: Serving -->
                    <div class="arch-layer serving">
                        <div class="layer-header-premium">
                            <div class="layer-number">05</div>
                            <div class="layer-title">
                                <i class="fas fa-chart-line"></i>
                                <span>DATA PRODUCTS</span>
                            </div>
                        </div>
                        <div class="serving-grid-premium">
                            <a href="https://www.snowflake.com/" target="_blank" class="serving-card warehouse">
                                <i class="fas fa-snowflake"></i>
                                <span>Snowflake</span>
                                <small>Cloud DW</small>
                            </a>
                            <a href="https://powerbi.microsoft.com/" target="_blank" class="serving-card bi">
                                <i class="fas fa-chart-pie"></i>
                                <span>Power BI</span>
                                <small>Dashboards</small>
                            </a>
                            <a href="https://grafana.com/" target="_blank" class="serving-card monitoring">
                                <i class="devicon-grafana-original colored"></i>
                                <span>Grafana</span>
                                <small>Monitoring</small>
                            </a>
                            <a href="https://www.tensorflow.org/" target="_blank" class="serving-card ml">
                                <i class="fas fa-brain"></i>
                                <span>ML Models</span>
                                <small>Predictions</small>
                            </a>
                            <a href="https://fastapi.tiangolo.com/" target="_blank" class="serving-card api">
                                <i class="fas fa-plug"></i>
                                <span>APIs</span>
                                <small>Data Products</small>
                            </a>
                            <a href="https://www.looker.com/" target="_blank" class="serving-card semantic">
                                <i class="fas fa-cubes"></i>
                                <span>Semantic</span>
                                <small>Metrics Layer</small>
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Orchestration Bar -->
                <div class="orchestration-premium">
                    <div class="orch-wrapper">
                        <div class="orch-icon-animated">
                            <i class="devicon-apacheairflow-plain"></i>
                        </div>
                        <div class="orch-info">
                            <span class="orch-name">Apache Airflow</span>
                            <span class="orch-role">Orchestration & Scheduling</span>
                        </div>
                        <div class="orch-stats">
                            <div class="orch-stat">
                                <span class="stat-num">156</span>
                                <span class="stat-label">DAGs</span>
                            </div>
                            <div class="orch-stat">
                                <span class="stat-num">12K</span>
                                <span class="stat-label">Tasks/day</span>
                            </div>
                            <div class="orch-stat success">
                                <span class="stat-num">99.8%</span>
                                <span class="stat-label">Success</span>
                            </div>
                        </div>
                        <div class="orch-status-badge running">
                            <span class="status-pulse"></span>
                            <span>All Systems Operational</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ==================== GOVERNANCE DIAGRAM ==================== -->
        <div id="pipeline-governance" class="pipeline-diagram-premium pipeline-mode">
            <!-- Premium Governance Framework -->
            <div class="gov-diagram-premium glass-card">
                <!-- Header with Compliance Status -->
                <div class="gov-premium-header">
                    <div class="gov-title-section">
                        <div class="gov-icon-animated">
                            <i class="fas fa-shield-alt"></i>
                            <div class="shield-glow"></div>
                        </div>
                        <div class="gov-title-text">
                            <h3>Enterprise Data Governance</h3>
                            <span class="gov-subtitle">Compliance, Quality & Security Framework</span>
                        </div>
                    </div>
                    <div class="compliance-badges">
                        <div class="compliance-badge gdpr">
                            <i class="fas fa-check-circle"></i>
                            <span>GDPR</span>
                        </div>
                        <div class="compliance-badge ccpa">
                            <i class="fas fa-check-circle"></i>
                            <span>CCPA</span>
                        </div>
                        <div class="compliance-badge soc2">
                            <i class="fas fa-check-circle"></i>
                            <span>SOC2</span>
                        </div>
                        <div class="compliance-badge hipaa">
                            <i class="fas fa-check-circle"></i>
                            <span>HIPAA</span>
                        </div>
                    </div>
                </div>

                <!-- Governance Pyramid -->
                <div class="gov-pyramid-container">
                    <!-- Level 1: Executive -->
                    <div class="pyramid-level executive">
                        <div class="level-header">
                            <div class="level-icon"><i class="fas fa-crown"></i></div>
                            <span class="level-title">GOVERNANCE COUNCIL</span>
                            <span class="level-badge">Strategic</span>
                        </div>
                        <div class="executive-row">
                            <div class="exec-card cdo">
                                <div class="exec-avatar">
                                    <i class="fas fa-user-tie"></i>
                                    <div class="exec-status online"></div>
                                </div>
                                <div class="exec-info">
                                    <span class="exec-role">Chief Data Officer</span>
                                    <span class="exec-dept">Data Strategy & Vision</span>
                                </div>
                                <div class="exec-tag">CDO</div>
                            </div>
                            <div class="exec-card ciso">
                                <div class="exec-avatar">
                                    <i class="fas fa-shield-alt"></i>
                                    <div class="exec-status online"></div>
                                </div>
                                <div class="exec-info">
                                    <span class="exec-role">Chief Security Officer</span>
                                    <span class="exec-dept">Data Protection</span>
                                </div>
                                <div class="exec-tag">CISO</div>
                            </div>
                            <div class="exec-card legal">
                                <div class="exec-avatar">
                                    <i class="fas fa-balance-scale"></i>
                                    <div class="exec-status online"></div>
                                </div>
                                <div class="exec-info">
                                    <span class="exec-role">Legal & Compliance</span>
                                    <span class="exec-dept">Regulatory Affairs</span>
                                </div>
                                <div class="exec-tag">CLO</div>
                            </div>
                            <div class="exec-card business">
                                <div class="exec-avatar">
                                    <i class="fas fa-briefcase"></i>
                                    <div class="exec-status online"></div>
                                </div>
                                <div class="exec-info">
                                    <span class="exec-role">Business Sponsors</span>
                                    <span class="exec-dept">Domain Leadership</span>
                                </div>
                                <div class="exec-tag">BIZ</div>
                            </div>
                        </div>
                    </div>

                    <!-- Connector -->
                    <div class="pyramid-connector">
                        <div class="connector-arrow">
                            <div class="arrow-body"></div>
                            <div class="arrow-head"><i class="fas fa-chevron-down"></i></div>
                        </div>
                        <span class="connector-text">Policies & Standards</span>
                    </div>

                    <!-- Level 2: Data Domains -->
                    <div class="pyramid-level domains">
                        <div class="level-header">
                            <div class="level-icon"><i class="fas fa-sitemap"></i></div>
                            <span class="level-title">DATA DOMAINS & STEWARDSHIP</span>
                            <span class="level-badge">Tactical</span>
                        </div>
                        <div class="domains-grid">
                            <div class="domain-card sales">
                                <div class="domain-icon"><i class="fas fa-chart-line"></i></div>
                                <div class="domain-content">
                                    <span class="domain-name">Sales & Marketing</span>
                                    <div class="domain-steward">
                                        <i class="fas fa-user"></i>
                                        <span>Revenue Ops Lead</span>
                                    </div>
                                    <div class="domain-assets">
                                        <span><i class="fas fa-table"></i> 45 tables</span>
                                        <span><i class="fas fa-chart-bar"></i> 12 metrics</span>
                                    </div>
                                </div>
                                <div class="domain-health good">
                                    <span class="health-score">98%</span>
                                </div>
                            </div>
                            <div class="domain-card finance">
                                <div class="domain-icon"><i class="fas fa-dollar-sign"></i></div>
                                <div class="domain-content">
                                    <span class="domain-name">Finance & Accounting</span>
                                    <div class="domain-steward">
                                        <i class="fas fa-user"></i>
                                        <span>CFO Office</span>
                                    </div>
                                    <div class="domain-assets">
                                        <span><i class="fas fa-table"></i> 32 tables</span>
                                        <span><i class="fas fa-chart-bar"></i> 8 metrics</span>
                                    </div>
                                </div>
                                <div class="domain-health good">
                                    <span class="health-score">99%</span>
                                </div>
                            </div>
                            <div class="domain-card customer">
                                <div class="domain-icon"><i class="fas fa-users"></i></div>
                                <div class="domain-content">
                                    <span class="domain-name">Customer 360</span>
                                    <div class="domain-steward">
                                        <i class="fas fa-user"></i>
                                        <span>CX Director</span>
                                    </div>
                                    <div class="domain-assets">
                                        <span><i class="fas fa-table"></i> 28 tables</span>
                                        <span><i class="fas fa-fingerprint"></i> PII</span>
                                    </div>
                                </div>
                                <div class="domain-health warning">
                                    <span class="health-score">94%</span>
                                </div>
                            </div>
                            <div class="domain-card product">
                                <div class="domain-icon"><i class="fas fa-box"></i></div>
                                <div class="domain-content">
                                    <span class="domain-name">Product & Operations</span>
                                    <div class="domain-steward">
                                        <i class="fas fa-user"></i>
                                        <span>Product Analytics</span>
                                    </div>
                                    <div class="domain-assets">
                                        <span><i class="fas fa-table"></i> 51 tables</span>
                                        <span><i class="fas fa-chart-bar"></i> 15 metrics</span>
                                    </div>
                                </div>
                                <div class="domain-health good">
                                    <span class="health-score">97%</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Connector -->
                    <div class="pyramid-connector">
                        <div class="connector-arrow">
                            <div class="arrow-body"></div>
                            <div class="arrow-head"><i class="fas fa-chevron-down"></i></div>
                        </div>
                        <span class="connector-text">Implementation</span>
                    </div>

                    <!-- Level 3: Technical Pillars -->
                    <div class="pyramid-level technical">
                        <div class="level-header">
                            <div class="level-icon"><i class="fas fa-cogs"></i></div>
                            <span class="level-title">TECHNICAL GOVERNANCE</span>
                            <span class="level-badge">Operational</span>
                        </div>
                        <div class="tech-pillars-premium">
                            <a href="https://atlan.com/" target="_blank" class="pillar-card-premium catalog">
                                <div class="pillar-glow"></div>
                                <div class="pillar-icon-wrap">
                                    <i class="fas fa-book-open"></i>
                                </div>
                                <div class="pillar-name">Data Catalog</div>
                                <div class="pillar-features">
                                    <span><i class="fas fa-search"></i> Discovery</span>
                                    <span><i class="fas fa-tags"></i> Metadata</span>
                                    <span><i class="fas fa-project-diagram"></i> Lineage</span>
                                </div>
                                <div class="pillar-tools-row">
                                    <span>Atlan</span>
                                    <span>DataHub</span>
                                    <span>Collibra</span>
                                </div>
                                <div class="pillar-metric">
                                    <span class="metric-num">156</span>
                                    <span class="metric-label">Assets</span>
                                </div>
                            </a>
                            <a href="https://greatexpectations.io/" target="_blank" class="pillar-card-premium quality">
                                <div class="pillar-glow"></div>
                                <div class="pillar-icon-wrap">
                                    <i class="fas fa-check-double"></i>
                                </div>
                                <div class="pillar-name">Data Quality</div>
                                <div class="pillar-features">
                                    <span><i class="fas fa-ruler"></i> Validation</span>
                                    <span><i class="fas fa-chart-bar"></i> Profiling</span>
                                    <span><i class="fas fa-bell"></i> Alerts</span>
                                </div>
                                <div class="pillar-tools-row">
                                    <span>Great Expectations</span>
                                    <span>Soda</span>
                                </div>
                                <div class="pillar-metric">
                                    <span class="metric-num">98.5%</span>
                                    <span class="metric-label">Score</span>
                                </div>
                            </a>
                            <a href="https://www.montecarlodata.com/" target="_blank" class="pillar-card-premium observability">
                                <div class="pillar-glow"></div>
                                <div class="pillar-icon-wrap">
                                    <i class="fas fa-eye"></i>
                                </div>
                                <div class="pillar-name">Observability</div>
                                <div class="pillar-features">
                                    <span><i class="fas fa-heartbeat"></i> Health</span>
                                    <span><i class="fas fa-clock"></i> Freshness</span>
                                    <span><i class="fas fa-bug"></i> Anomalies</span>
                                </div>
                                <div class="pillar-tools-row">
                                    <span>Monte Carlo</span>
                                    <span>Bigeye</span>
                                </div>
                                <div class="pillar-metric">
                                    <span class="metric-num">24/7</span>
                                    <span class="metric-label">Monitoring</span>
                                </div>
                            </a>
                            <a href="https://privacera.com/" target="_blank" class="pillar-card-premium security">
                                <div class="pillar-glow"></div>
                                <div class="pillar-icon-wrap">
                                    <i class="fas fa-lock"></i>
                                </div>
                                <div class="pillar-name">Access Control</div>
                                <div class="pillar-features">
                                    <span><i class="fas fa-user-shield"></i> RBAC</span>
                                    <span><i class="fas fa-mask"></i> Masking</span>
                                    <span><i class="fas fa-key"></i> Encryption</span>
                                </div>
                                <div class="pillar-tools-row">
                                    <span>Privacera</span>
                                    <span>Immuta</span>
                                </div>
                                <div class="pillar-metric">
                                    <span class="metric-num">100%</span>
                                    <span class="metric-label">Compliant</span>
                                </div>
                            </a>
                        </div>
                    </div>

                    <!-- Data Classification -->
                    <div class="classification-premium">
                        <div class="class-header">
                            <i class="fas fa-fingerprint"></i>
                            <span>DATA CLASSIFICATION</span>
                        </div>
                        <div class="class-spectrum">
                            <div class="class-item public">
                                <div class="class-dot"></div>
                                <div class="class-info">
                                    <span class="class-label">PUBLIC</span>
                                    <span class="class-count">42 assets</span>
                                </div>
                                <div class="class-actions">
                                    <i class="fas fa-globe" title="No restrictions"></i>
                                </div>
                            </div>
                            <div class="class-item internal">
                                <div class="class-dot"></div>
                                <div class="class-info">
                                    <span class="class-label">INTERNAL</span>
                                    <span class="class-count">89 assets</span>
                                </div>
                                <div class="class-actions">
                                    <i class="fas fa-building" title="Internal only"></i>
                                </div>
                            </div>
                            <div class="class-item confidential">
                                <div class="class-dot"></div>
                                <div class="class-info">
                                    <span class="class-label">CONFIDENTIAL</span>
                                    <span class="class-count">18 assets</span>
                                </div>
                                <div class="class-actions">
                                    <i class="fas fa-lock" title="Restricted access"></i>
                                </div>
                            </div>
                            <div class="class-item pii">
                                <div class="class-dot"></div>
                                <div class="class-info">
                                    <span class="class-label">PII / SENSITIVE</span>
                                    <span class="class-count">7 assets</span>
                                </div>
                                <div class="class-actions">
                                    <i class="fas fa-mask" title="Masked"></i>
                                    <i class="fas fa-key" title="Encrypted"></i>
                                    <i class="fas fa-clock" title="Retention policy"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Governance Dashboard Footer -->
                <div class="gov-dashboard-footer">
                    <div class="dashboard-metrics">
                        <div class="dash-metric">
                            <div class="metric-icon quality"><i class="fas fa-check-circle"></i></div>
                            <div class="metric-content">
                                <span class="metric-value">98.5%</span>
                                <span class="metric-name">Data Quality</span>
                            </div>
                            <div class="metric-trend up"><i class="fas fa-arrow-up"></i> 2.1%</div>
                        </div>
                        <div class="dash-metric">
                            <div class="metric-icon coverage"><i class="fas fa-book"></i></div>
                            <div class="metric-content">
                                <span class="metric-value">156</span>
                                <span class="metric-name">Catalogued</span>
                            </div>
                            <div class="metric-trend up"><i class="fas fa-arrow-up"></i> 12</div>
                        </div>
                        <div class="dash-metric">
                            <div class="metric-icon compliance"><i class="fas fa-shield-alt"></i></div>
                            <div class="metric-content">
                                <span class="metric-value">100%</span>
                                <span class="metric-name">PII Compliant</span>
                            </div>
                            <div class="metric-trend stable"><i class="fas fa-minus"></i></div>
                        </div>
                        <div class="dash-metric">
                            <div class="metric-icon freshness"><i class="fas fa-clock"></i></div>
                            <div class="metric-content">
                                <span class="metric-value">99.9%</span>
                                <span class="metric-name">SLA Met</span>
                            </div>
                            <div class="metric-trend up"><i class="fas fa-arrow-up"></i> 0.3%</div>
                        </div>
                    </div>
                    <div class="dashboard-status">
                        <span class="status-indicator healthy"></span>
                        <span>All governance checks passing</span>
                        <span class="last-updated">Updated 2 min ago</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script is:inline>
    // Pipeline Mode Switcher
    function switchPipelineMode(mode) {
        // Update buttons - remove active from all, add to clicked
        var buttons = document.querySelectorAll('.mode-btn');
        buttons.forEach(function(btn) {
            btn.classList.remove('active');
            if (btn.dataset.mode === mode) {
                btn.classList.add('active');
            }
        });

        // Update pipeline views - hide all, show selected
        var pipelines = document.querySelectorAll('.pipeline-mode');
        pipelines.forEach(function(pipeline) {
            pipeline.classList.remove('active');
        });

        var targetPipeline = document.getElementById('pipeline-' + mode);
        if (targetPipeline) {
            targetPipeline.classList.add('active');
        }
    }

    // Initialize pipeline buttons
    function initPipelineButtons() {
        var btnRealtime = document.getElementById('btn-realtime');
        var btnBatch = document.getElementById('btn-batch');
        var btnArchitecture = document.getElementById('btn-architecture');
        var btnGovernance = document.getElementById('btn-governance');

        if (btnRealtime) {
            btnRealtime.onclick = function() { switchPipelineMode('realtime'); };
        }
        if (btnBatch) {
            btnBatch.onclick = function() { switchPipelineMode('batch'); };
        }
        if (btnArchitecture) {
            btnArchitecture.onclick = function() { switchPipelineMode('architecture'); };
        }
        if (btnGovernance) {
            btnGovernance.onclick = function() { switchPipelineMode('governance'); };
        }
    }

    // Add event listeners for both initial load and Astro View Transitions
    document.addEventListener('DOMContentLoaded', initPipelineButtons);
    document.addEventListener('astro:page-load', initPipelineButtons);
</script>
