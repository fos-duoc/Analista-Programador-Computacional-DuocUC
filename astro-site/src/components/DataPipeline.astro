---
// Data Pipeline Section - Real-time and Batch processing views
---

<section id="pipeline" class="pipeline-section">
    <!-- Premium Header -->
    <div class="pipeline-hero-header" data-aos="fade-up">
        <div class="pipeline-title-wrap">
            <div class="pipeline-icon-glow">
                <i class="fas fa-project-diagram"></i>
            </div>
            <div class="pipeline-title-content">
                <h2 class="pipeline-main-title">Data Pipeline <span class="gradient-text">End-to-End</span></h2>
                <p class="pipeline-tagline">Arquitectura moderna de flujo de datos en tiempo real y batch</p>
            </div>
        </div>
        <!-- Mode Selector Buttons -->
        <div class="pipeline-mode-selector">
            <button class="mode-btn active" data-mode="realtime" id="btn-realtime">
                <i class="fas fa-bolt"></i>
                <span>Real-time Streaming</span>
                <small>Latencia &lt; 1s</small>
            </button>
            <button class="mode-btn" data-mode="batch" id="btn-batch">
                <i class="fas fa-layer-group"></i>
                <span>Batch Processing</span>
                <small>Alto volumen</small>
            </button>
            <button class="mode-btn" data-mode="architecture" id="btn-architecture">
                <i class="fas fa-stream"></i>
                <span>Pipeline Architecture</span>
                <small>E2E Diagram</small>
            </button>
            <button class="mode-btn" data-mode="governance" id="btn-governance">
                <i class="fas fa-shield-alt"></i>
                <span>Data Governance</span>
                <small>Framework</small>
            </button>
        </div>
    </div>

    <!-- Pipeline Diagrams Container -->
    <div class="pipeline-container" data-aos="fade-up" data-aos-delay="100">

        <!-- ==================== REAL-TIME STREAMING PIPELINE ==================== -->
        <div id="pipeline-realtime" class="pipeline-diagram-premium pipeline-mode active">
            <!-- Pipeline Header -->
            <div class="pipeline-mode-header realtime">
                <div class="mode-indicator">
                    <i class="fas fa-bolt"></i>
                    <span>Real-time Streaming Pipeline</span>
                </div>
                <div class="mode-stats">
                    <span class="stat-pill"><i class="fas fa-clock"></i> Latencia: &lt;1s</span>
                    <span class="stat-pill"><i class="fas fa-tachometer-alt"></i> 100K+ events/s</span>
                    <span class="stat-pill"><i class="fas fa-sync"></i> 24/7 Continuous</span>
                </div>
            </div>

            <!-- Animated Connection Line -->
            <div class="pipeline-connection-line realtime-line">
                <div class="data-flow-animation fast"></div>
            </div>

            <!-- Pipeline Stages -->
            <div class="pipeline-stages-grid">
                <!-- Stage 1: Ingest -->
                <div class="pipeline-stage-card">
                    <div class="stage-number">01</div>
                    <div class="stage-icon-premium extract">
                        <i class="fas fa-satellite-dish"></i>
                    </div>
                    <div class="stage-content">
                        <h4 class="stage-title">Ingest</h4>
                        <p class="stage-desc">Event Streaming</p>
                    </div>
                    <div class="stage-tech-stack">
                        <a href="https://kafka.apache.org/" target="_blank" class="tech-mini"><i class="devicon-apachekafka-original"></i> Kafka</a>
                        <a href="https://aws.amazon.com/kinesis/" target="_blank" class="tech-mini"><i class="devicon-amazonwebservices-plain-wordmark"></i> Kinesis</a>
                        <a href="https://pulsar.apache.org/" target="_blank" class="tech-mini"><i class="fas fa-meteor"></i> Pulsar</a>
                        <a href="https://www.rabbitmq.com/" target="_blank" class="tech-mini"><i class="fas fa-rabbit"></i> RabbitMQ</a>
                    </div>
                </div>
                <div class="stage-arrow"><i class="fas fa-arrow-right"></i></div>

                <!-- Stage 2: Process -->
                <div class="pipeline-stage-card">
                    <div class="stage-number">02</div>
                    <div class="stage-icon-premium transform">
                        <i class="fas fa-bolt"></i>
                    </div>
                    <div class="stage-content">
                        <h4 class="stage-title">Process</h4>
                        <p class="stage-desc">Stream Processing</p>
                    </div>
                    <div class="stage-tech-stack">
                        <a href="https://flink.apache.org/" target="_blank" class="tech-mini"><i class="fas fa-water"></i> Flink</a>
                        <a href="https://spark.apache.org/streaming/" target="_blank" class="tech-mini"><i class="devicon-apachespark-original colored"></i> Spark</a>
                        <a href="https://kafka.apache.org/documentation/streams/" target="_blank" class="tech-mini"><i class="devicon-apachekafka-original"></i> Streams</a>
                        <a href="https://storm.apache.org/" target="_blank" class="tech-mini"><i class="fas fa-wind"></i> Storm</a>
                    </div>
                </div>
                <div class="stage-arrow"><i class="fas fa-arrow-right"></i></div>

                <!-- Stage 3: Store -->
                <div class="pipeline-stage-card">
                    <div class="stage-number">03</div>
                    <div class="stage-icon-premium load">
                        <i class="fas fa-database"></i>
                    </div>
                    <div class="stage-content">
                        <h4 class="stage-title">Store</h4>
                        <p class="stage-desc">Real-time Storage</p>
                    </div>
                    <div class="stage-tech-stack">
                        <a href="https://redis.io/" target="_blank" class="tech-mini"><i class="devicon-redis-plain colored"></i> Redis</a>
                        <a href="https://www.elastic.co/" target="_blank" class="tech-mini"><i class="devicon-elasticsearch-plain colored"></i> Elastic</a>
                        <a href="https://cassandra.apache.org/" target="_blank" class="tech-mini"><i class="fas fa-eye"></i> Cassandra</a>
                        <a href="https://clickhouse.com/" target="_blank" class="tech-mini"><i class="fas fa-mouse-pointer"></i> ClickHouse</a>
                    </div>
                </div>
                <div class="stage-arrow"><i class="fas fa-arrow-right"></i></div>

                <!-- Stage 4: Serve -->
                <div class="pipeline-stage-card">
                    <div class="stage-number">04</div>
                    <div class="stage-icon-premium serve">
                        <i class="fas fa-desktop"></i>
                    </div>
                    <div class="stage-content">
                        <h4 class="stage-title">Serve</h4>
                        <p class="stage-desc">Real-time Dashboards</p>
                    </div>
                    <div class="stage-tech-stack">
                        <a href="https://grafana.com/" target="_blank" class="tech-mini"><i class="devicon-grafana-original colored"></i> Grafana</a>
                        <a href="https://www.elastic.co/kibana" target="_blank" class="tech-mini"><i class="fas fa-chart-line"></i> Kibana</a>
                        <a href="https://superset.apache.org/" target="_blank" class="tech-mini"><i class="fas fa-tachometer-alt"></i> Superset</a>
                        <a href="https://socket.io/" target="_blank" class="tech-mini"><i class="fas fa-plug"></i> WebSockets</a>
                    </div>
                </div>
            </div>

            <!-- Orchestration Layer for Real-time -->
            <div class="pipeline-layers">
                <div class="layer-card orchestration">
                    <div class="layer-icon"><i class="fas fa-network-wired"></i></div>
                    <div class="layer-info">
                        <span class="layer-label">EVENT BROKER</span>
                        <span class="layer-name">Apache Kafka</span>
                    </div>
                    <div class="layer-status running">
                        <span class="status-indicator"></span>
                        <span>Streaming</span>
                    </div>
                    <div class="layer-extras">
                        <span class="extra-badge"><i class="fas fa-server"></i> 12 Brokers</span>
                        <span class="extra-badge"><i class="fas fa-layer-group"></i> 50 Topics</span>
                    </div>
                </div>
                <div class="layer-card quality">
                    <div class="layer-icon"><i class="fas fa-shield-alt"></i></div>
                    <div class="layer-info">
                        <span class="layer-label">SCHEMA REGISTRY</span>
                        <span class="layer-name">Confluent</span>
                    </div>
                    <div class="layer-status healthy">
                        <span class="status-indicator"></span>
                        <span>Validating</span>
                    </div>
                    <div class="layer-extras">
                        <span class="extra-badge"><i class="fas fa-file-code"></i> Avro/Proto</span>
                        <span class="extra-badge"><i class="fas fa-history"></i> Versioned</span>
                    </div>
                </div>
                <div class="layer-card observability">
                    <div class="layer-icon"><i class="fas fa-heartbeat"></i></div>
                    <div class="layer-info">
                        <span class="layer-label">MONITORING</span>
                        <span class="layer-name">Prometheus + Grafana</span>
                    </div>
                    <div class="layer-status monitoring">
                        <span class="status-indicator"></span>
                        <span>Live Metrics</span>
                    </div>
                    <div class="layer-extras">
                        <span class="extra-badge"><i class="fas fa-bell"></i> Alerting</span>
                        <span class="extra-badge"><i class="fas fa-chart-area"></i> Dashboards</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- ==================== BATCH PROCESSING PIPELINE ==================== -->
        <div id="pipeline-batch" class="pipeline-diagram-premium pipeline-mode">
            <!-- Pipeline Header -->
            <div class="pipeline-mode-header batch">
                <div class="mode-indicator">
                    <i class="fas fa-layer-group"></i>
                    <span>Batch Processing Pipeline</span>
                </div>
                <div class="mode-stats">
                    <span class="stat-pill"><i class="fas fa-database"></i> Petabytes</span>
                    <span class="stat-pill"><i class="fas fa-calendar-alt"></i> Daily/Hourly</span>
                    <span class="stat-pill"><i class="fas fa-check-double"></i> ACID Compliant</span>
                </div>
            </div>

            <!-- Animated Connection Line -->
            <div class="pipeline-connection-line batch-line">
                <div class="data-flow-animation"></div>
            </div>

            <!-- Pipeline Stages -->
            <div class="pipeline-stages-grid">
                <!-- Stage 1: Extract -->
                <div class="pipeline-stage-card">
                    <div class="stage-number">01</div>
                    <div class="stage-icon-premium extract">
                        <i class="fas fa-file-import"></i>
                    </div>
                    <div class="stage-content">
                        <h4 class="stage-title">Extract</h4>
                        <p class="stage-desc">Data Sources</p>
                    </div>
                    <div class="stage-tech-stack">
                        <a href="https://www.postgresql.org/" target="_blank" class="tech-mini"><i class="devicon-postgresql-plain colored"></i> PostgreSQL</a>
                        <a href="https://aws.amazon.com/s3/" target="_blank" class="tech-mini"><i class="devicon-amazonwebservices-plain-wordmark"></i> S3/GCS</a>
                        <a href="https://www.snowflake.com/" target="_blank" class="tech-mini"><i class="fas fa-snowflake"></i> APIs</a>
                        <a href="https://www.fivetran.com/" target="_blank" class="tech-mini"><i class="fas fa-plug"></i> Fivetran</a>
                    </div>
                </div>
                <div class="stage-arrow"><i class="fas fa-arrow-right"></i></div>

                <!-- Stage 2: Transform -->
                <div class="pipeline-stage-card">
                    <div class="stage-number">02</div>
                    <div class="stage-icon-premium transform">
                        <i class="fas fa-cogs"></i>
                    </div>
                    <div class="stage-content">
                        <h4 class="stage-title">Transform</h4>
                        <p class="stage-desc">ETL / ELT</p>
                    </div>
                    <div class="stage-tech-stack">
                        <a href="https://spark.apache.org/" target="_blank" class="tech-mini"><i class="devicon-apachespark-original colored"></i> Spark</a>
                        <a href="https://www.getdbt.com/" target="_blank" class="tech-mini"><i class="fas fa-code-branch"></i> dbt</a>
                        <a href="https://www.python.org/" target="_blank" class="tech-mini"><i class="devicon-python-plain colored"></i> Python</a>
                        <a href="https://pandas.pydata.org/" target="_blank" class="tech-mini"><i class="fas fa-table"></i> Pandas</a>
                    </div>
                </div>
                <div class="stage-arrow"><i class="fas fa-arrow-right"></i></div>

                <!-- Stage 3: Load -->
                <div class="pipeline-stage-card">
                    <div class="stage-number">03</div>
                    <div class="stage-icon-premium load">
                        <i class="fas fa-warehouse"></i>
                    </div>
                    <div class="stage-content">
                        <h4 class="stage-title">Load</h4>
                        <p class="stage-desc">Data Warehouse</p>
                    </div>
                    <div class="stage-tech-stack">
                        <a href="https://www.snowflake.com/" target="_blank" class="tech-mini"><i class="fas fa-snowflake"></i> Snowflake</a>
                        <a href="https://www.databricks.com/" target="_blank" class="tech-mini"><i class="fas fa-cubes"></i> Databricks</a>
                        <a href="https://cloud.google.com/bigquery" target="_blank" class="tech-mini"><i class="devicon-googlecloud-plain colored"></i> BigQuery</a>
                        <a href="https://aws.amazon.com/redshift/" target="_blank" class="tech-mini"><i class="devicon-amazonwebservices-plain-wordmark"></i> Redshift</a>
                    </div>
                </div>
                <div class="stage-arrow"><i class="fas fa-arrow-right"></i></div>

                <!-- Stage 4: Analyze -->
                <div class="pipeline-stage-card">
                    <div class="stage-number">04</div>
                    <div class="stage-icon-premium serve">
                        <i class="fas fa-chart-pie"></i>
                    </div>
                    <div class="stage-content">
                        <h4 class="stage-title">Analyze</h4>
                        <p class="stage-desc">BI & Analytics</p>
                    </div>
                    <div class="stage-tech-stack">
                        <a href="https://powerbi.microsoft.com/" target="_blank" class="tech-mini"><i class="fas fa-chart-pie"></i> Power BI</a>
                        <a href="https://www.tableau.com/" target="_blank" class="tech-mini"><i class="fas fa-chart-area"></i> Tableau</a>
                        <a href="https://looker.com/" target="_blank" class="tech-mini"><i class="fas fa-eye"></i> Looker</a>
                        <a href="https://metabase.com/" target="_blank" class="tech-mini"><i class="fas fa-chart-bar"></i> Metabase</a>
                    </div>
                </div>
            </div>

            <!-- Orchestration Layer for Batch -->
            <div class="pipeline-layers">
                <div class="layer-card orchestration">
                    <div class="layer-icon"><i class="devicon-apacheairflow-plain"></i></div>
                    <div class="layer-info">
                        <span class="layer-label">ORCHESTRATION</span>
                        <span class="layer-name">Apache Airflow</span>
                    </div>
                    <div class="layer-status running">
                        <span class="status-indicator"></span>
                        <span>DAG Active</span>
                    </div>
                    <div class="layer-extras">
                        <span class="extra-badge"><i class="fas fa-clock"></i> Cron: 0 6 * * *</span>
                        <span class="extra-badge"><i class="fas fa-redo"></i> Retries: 3</span>
                    </div>
                </div>
                <div class="layer-card quality">
                    <div class="layer-icon"><i class="fas fa-shield-alt"></i></div>
                    <div class="layer-info">
                        <span class="layer-label">DATA QUALITY</span>
                        <span class="layer-name">Great Expectations</span>
                    </div>
                    <div class="layer-status healthy">
                        <span class="status-indicator"></span>
                        <span>Tests Passing</span>
                    </div>
                    <div class="layer-extras">
                        <span class="extra-badge"><i class="fas fa-check-circle"></i> 47 Expectations</span>
                        <span class="extra-badge"><i class="fas fa-percentage"></i> 99.8% Pass</span>
                    </div>
                </div>
                <div class="layer-card observability">
                    <div class="layer-icon"><i class="fas fa-eye"></i></div>
                    <div class="layer-info">
                        <span class="layer-label">DATA CATALOG</span>
                        <span class="layer-name">DataHub / Atlan</span>
                    </div>
                    <div class="layer-status monitoring">
                        <span class="status-indicator"></span>
                        <span>Cataloging</span>
                    </div>
                    <div class="layer-extras">
                        <span class="extra-badge"><i class="fas fa-table"></i> 156 Tables</span>
                        <span class="extra-badge"><i class="fas fa-sitemap"></i> Lineage</span>
                    </div>
                </div>
            </div>

            <!-- Airflow DAG Code -->
            <div class="dag-code-container glass-card">
                <div class="code-header">
                    <div class="code-file">
                        <i class="devicon-python-plain colored"></i>
                        <span>etl_dag.py</span>
                    </div>
                    <div class="code-badges">
                        <span class="code-badge airflow"><i class="devicon-apacheairflow-plain"></i> Airflow 2.x</span>
                        <span class="code-badge python"><i class="devicon-python-plain"></i> Python 3.11</span>
                    </div>
                </div>
                <div class="code-block">
                    <pre><code class="language-python"><span class="code-comment"># etl_dag.py - Pipeline de datos completo</span>
<span class="code-keyword">from</span> airflow <span class="code-keyword">import</span> DAG
<span class="code-keyword">from</span> airflow.operators.python <span class="code-keyword">import</span> PythonOperator
<span class="code-keyword">from</span> airflow.providers.postgres.operators.postgres <span class="code-keyword">import</span> PostgresOperator
<span class="code-keyword">from</span> datetime <span class="code-keyword">import</span> datetime, timedelta

<span class="code-comment"># Configuraci√≥n del DAG</span>
default_args = &#123;
    <span class="code-string">'owner'</span>: <span class="code-string">'data-team'</span>,
    <span class="code-string">'depends_on_past'</span>: <span class="code-keyword">False</span>,
    <span class="code-string">'start_date'</span>: datetime(<span class="code-number">2025</span>, <span class="code-number">1</span>, <span class="code-number">1</span>),
    <span class="code-string">'retries'</span>: <span class="code-number">3</span>,
    <span class="code-string">'retry_delay'</span>: timedelta(minutes=<span class="code-number">5</span>),
&#125;

<span class="code-keyword">with</span> DAG(
    <span class="code-string">'etl_pipeline_prod'</span>,
    default_args=default_args,
    schedule_interval=<span class="code-string">'0 6 * * *'</span>,  <span class="code-comment"># Diario a las 6 AM</span>
    catchup=<span class="code-keyword">False</span>,
    tags=[<span class="code-string">'etl'</span>, <span class="code-string">'production'</span>]
) <span class="code-keyword">as</span> dag:

    <span class="code-comment"># Task 1: Extraer datos desde API</span>
    extract = PythonOperator(
        task_id=<span class="code-string">'extract_from_api'</span>,
        python_callable=extract_data
    )

    <span class="code-comment"># Task 2: Transformar con Spark</span>
    transform = PythonOperator(
        task_id=<span class="code-string">'transform_spark'</span>,
        python_callable=spark_transform
    )

    <span class="code-comment"># Task 3: Cargar a Data Warehouse</span>
    load = PostgresOperator(
        task_id=<span class="code-string">'load_to_warehouse'</span>,
        postgres_conn_id=<span class="code-string">'warehouse_conn'</span>,
        sql=<span class="code-string">'sql/load_facts.sql'</span>
    )

    <span class="code-comment"># Definir dependencias</span>
    extract >> transform >> load</code></pre>
                </div>
                <div class="code-footer">
                    <span class="code-meta"><i class="fas fa-clock"></i> Schedule: Daily 6:00 AM</span>
                    <span class="code-meta"><i class="fas fa-tags"></i> Tags: etl, production</span>
                </div>
            </div>
        </div>

        <!-- ==================== ARCHITECTURE DIAGRAM ==================== -->
        <div id="pipeline-architecture" class="pipeline-diagram-premium pipeline-mode">
            <!-- ========== DIAGRAM 1: END-TO-END PIPELINE FLOW ========== -->
            <div class="visual-diagram-box glass-card">
                <div class="diagram-header">
                    <div class="diagram-title-row">
                        <div class="diagram-icon pipeline-icon">
                            <i class="fas fa-stream"></i>
                        </div>
                        <div class="diagram-title-content">
                            <h3>Data Pipeline Architecture</h3>
                            <span class="diagram-subtitle">End-to-End Data Flow Diagram</span>
                        </div>
                    </div>
                    <div class="diagram-badges">
                        <span class="diagram-badge realtime"><i class="fas fa-bolt"></i> Real-time</span>
                        <span class="diagram-badge batch"><i class="fas fa-layer-group"></i> Batch</span>
                    </div>
                </div>

                <div class="pipeline-visual-diagram">
                    <!-- Data Sources Layer -->
                    <div class="diagram-layer sources-layer">
                        <div class="layer-label">
                            <i class="fas fa-database"></i>
                            <span>DATA SOURCES</span>
                        </div>
                        <div class="layer-nodes">
                            <div class="source-node">
                                <i class="fas fa-mobile-alt"></i>
                                <span>Apps</span>
                                <small>Events</small>
                            </div>
                            <div class="source-node">
                                <i class="fas fa-server"></i>
                                <span>APIs</span>
                                <small>REST/GraphQL</small>
                            </div>
                            <div class="source-node">
                                <i class="devicon-postgresql-plain colored"></i>
                                <span>OLTP</span>
                                <small>PostgreSQL</small>
                            </div>
                            <div class="source-node">
                                <i class="fas fa-file-csv"></i>
                                <span>Files</span>
                                <small>CSV/JSON</small>
                            </div>
                            <div class="source-node">
                                <i class="fas fa-cloud"></i>
                                <span>SaaS</span>
                                <small>Salesforce</small>
                            </div>
                        </div>
                    </div>

                    <!-- Flow Arrow -->
                    <div class="flow-arrow-vertical">
                        <div class="arrow-line"></div>
                        <div class="arrow-label">Ingestion</div>
                        <i class="fas fa-chevron-down"></i>
                    </div>

                    <!-- Ingestion Layer -->
                    <div class="diagram-layer ingestion-layer">
                        <div class="layer-label">
                            <i class="fas fa-download"></i>
                            <span>INGESTION</span>
                        </div>
                        <div class="layer-tools">
                            <div class="tool-box streaming">
                                <div class="tool-header">
                                    <i class="devicon-apachekafka-original"></i>
                                    <span>Kafka</span>
                                </div>
                                <div class="tool-detail">Streaming Events</div>
                            </div>
                            <div class="tool-box batch">
                                <div class="tool-header">
                                    <i class="fas fa-plug"></i>
                                    <span>Fivetran</span>
                                </div>
                                <div class="tool-detail">CDC / Batch Sync</div>
                            </div>
                            <div class="tool-box api">
                                <div class="tool-header">
                                    <i class="devicon-python-plain colored"></i>
                                    <span>Custom</span>
                                </div>
                                <div class="tool-detail">Python Scripts</div>
                            </div>
                        </div>
                    </div>

                    <!-- Flow Arrow -->
                    <div class="flow-arrow-vertical">
                        <div class="arrow-line"></div>
                        <div class="arrow-label">Raw Data</div>
                        <i class="fas fa-chevron-down"></i>
                    </div>

                    <!-- Storage Layer (Data Lake) -->
                    <div class="diagram-layer storage-layer">
                        <div class="layer-label">
                            <i class="fas fa-water"></i>
                            <span>DATA LAKE / LAKEHOUSE</span>
                        </div>
                        <div class="lake-zones">
                            <div class="lake-zone bronze">
                                <div class="zone-header">
                                    <span class="zone-badge">BRONZE</span>
                                    <span class="zone-name">Raw Zone</span>
                                </div>
                                <div class="zone-detail">
                                    <i class="fas fa-file-archive"></i>
                                    <span>Landing, as-is data</span>
                                </div>
                            </div>
                            <div class="zone-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="lake-zone silver">
                                <div class="zone-header">
                                    <span class="zone-badge">SILVER</span>
                                    <span class="zone-name">Cleaned</span>
                                </div>
                                <div class="zone-detail">
                                    <i class="fas fa-broom"></i>
                                    <span>Validated, deduplicated</span>
                                </div>
                            </div>
                            <div class="zone-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="lake-zone gold">
                                <div class="zone-header">
                                    <span class="zone-badge">GOLD</span>
                                    <span class="zone-name">Business</span>
                                </div>
                                <div class="zone-detail">
                                    <i class="fas fa-gem"></i>
                                    <span>Aggregated, ready</span>
                                </div>
                            </div>
                        </div>
                        <div class="lake-tech">
                            <span class="tech-chip"><i class="fas fa-snowflake"></i> Delta Lake</span>
                            <span class="tech-chip"><i class="fas fa-cubes"></i> Iceberg</span>
                            <span class="tech-chip"><i class="devicon-amazonwebservices-plain-wordmark"></i> S3</span>
                        </div>
                    </div>

                    <!-- Flow Arrow -->
                    <div class="flow-arrow-vertical">
                        <div class="arrow-line"></div>
                        <div class="arrow-label">Transform</div>
                        <i class="fas fa-chevron-down"></i>
                    </div>

                    <!-- Processing Layer -->
                    <div class="diagram-layer processing-layer">
                        <div class="layer-label">
                            <i class="fas fa-cogs"></i>
                            <span>PROCESSING & TRANSFORMATION</span>
                        </div>
                        <div class="processing-engines">
                            <div class="engine-box">
                                <i class="devicon-apachespark-original colored"></i>
                                <span>Spark</span>
                                <small>Distributed Processing</small>
                            </div>
                            <div class="engine-box">
                                <i class="fas fa-code-branch"></i>
                                <span>dbt</span>
                                <small>SQL Transformations</small>
                            </div>
                            <div class="engine-box">
                                <i class="fas fa-water"></i>
                                <span>Flink</span>
                                <small>Stream Processing</small>
                            </div>
                        </div>
                    </div>

                    <!-- Flow Arrow -->
                    <div class="flow-arrow-vertical">
                        <div class="arrow-line"></div>
                        <div class="arrow-label">Curated Data</div>
                        <i class="fas fa-chevron-down"></i>
                    </div>

                    <!-- Data Warehouse -->
                    <div class="diagram-layer warehouse-layer">
                        <div class="layer-label">
                            <i class="fas fa-warehouse"></i>
                            <span>DATA WAREHOUSE</span>
                        </div>
                        <div class="warehouse-box">
                            <div class="dw-icon">
                                <i class="fas fa-snowflake"></i>
                            </div>
                            <div class="dw-content">
                                <span class="dw-name">Snowflake / BigQuery / Databricks</span>
                                <div class="dw-features">
                                    <span><i class="fas fa-check"></i> Star Schema</span>
                                    <span><i class="fas fa-check"></i> OLAP Optimized</span>
                                    <span><i class="fas fa-check"></i> Semantic Layer</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Flow Arrow -->
                    <div class="flow-arrow-vertical">
                        <div class="arrow-line"></div>
                        <div class="arrow-label">Analytics</div>
                        <i class="fas fa-chevron-down"></i>
                    </div>

                    <!-- Visualization Layer -->
                    <div class="diagram-layer visualization-layer">
                        <div class="layer-label">
                            <i class="fas fa-chart-line"></i>
                            <span>VISUALIZATION & CONSUMPTION</span>
                        </div>
                        <div class="viz-tools">
                            <div class="viz-box">
                                <i class="fas fa-chart-pie"></i>
                                <span>Power BI</span>
                                <small>BI Reports</small>
                            </div>
                            <div class="viz-box">
                                <i class="fas fa-chart-area"></i>
                                <span>Tableau</span>
                                <small>Dashboards</small>
                            </div>
                            <div class="viz-box">
                                <i class="devicon-grafana-original colored"></i>
                                <span>Grafana</span>
                                <small>Monitoring</small>
                            </div>
                            <div class="viz-box">
                                <i class="fas fa-robot"></i>
                                <span>ML Models</span>
                                <small>Predictions</small>
                            </div>
                            <div class="viz-box">
                                <i class="fas fa-code"></i>
                                <span>APIs</span>
                                <small>Data Products</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Orchestration Footer -->
                <div class="diagram-footer">
                    <div class="orchestration-bar">
                        <div class="orch-label">
                            <i class="devicon-apacheairflow-plain"></i>
                            <span>Orchestration: Apache Airflow</span>
                        </div>
                        <div class="orch-status">
                            <span class="status-dot running"></span>
                            <span>Pipeline Healthy</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ==================== GOVERNANCE DIAGRAM ==================== -->
        <div id="pipeline-governance" class="pipeline-diagram-premium pipeline-mode">
            <!-- ========== DIAGRAM 2: DATA GOVERNANCE FRAMEWORK ========== -->
            <div class="visual-diagram-box glass-card governance-diagram">
                <div class="diagram-header">
                    <div class="diagram-title-row">
                        <div class="diagram-icon governance-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <div class="diagram-title-content">
                            <h3>Data Governance Framework</h3>
                            <span class="diagram-subtitle">Roles, Responsabilidades y Flujo de Gobernanza</span>
                        </div>
                    </div>
                    <div class="diagram-badges">
                        <span class="diagram-badge compliance"><i class="fas fa-gavel"></i> GDPR</span>
                        <span class="diagram-badge compliance"><i class="fas fa-user-shield"></i> CCPA</span>
                        <span class="diagram-badge compliance"><i class="fas fa-check-double"></i> SOC2</span>
                    </div>
                </div>

                <div class="governance-visual-diagram">
                    <!-- Governance Council -->
                    <div class="gov-tier council-tier">
                        <div class="tier-header">
                            <i class="fas fa-users-cog"></i>
                            <span>DATA GOVERNANCE COUNCIL</span>
                        </div>
                        <div class="council-members">
                            <div class="member-card chief">
                                <div class="member-avatar">
                                    <i class="fas fa-user-tie"></i>
                                </div>
                                <div class="member-info">
                                    <span class="member-role">Chief Data Officer</span>
                                    <span class="member-resp">Strategic Leadership</span>
                                </div>
                                <div class="member-badge cdo">CDO</div>
                            </div>
                            <div class="member-card">
                                <div class="member-avatar">
                                    <i class="fas fa-balance-scale"></i>
                                </div>
                                <div class="member-info">
                                    <span class="member-role">Legal & Compliance</span>
                                    <span class="member-resp">Regulatory Oversight</span>
                                </div>
                            </div>
                            <div class="member-card">
                                <div class="member-avatar">
                                    <i class="fas fa-shield-alt"></i>
                                </div>
                                <div class="member-info">
                                    <span class="member-role">Security Officer</span>
                                    <span class="member-resp">Data Protection</span>
                                </div>
                            </div>
                            <div class="member-card">
                                <div class="member-avatar">
                                    <i class="fas fa-building"></i>
                                </div>
                                <div class="member-info">
                                    <span class="member-role">Business Sponsors</span>
                                    <span class="member-resp">Domain Representatives</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Connection Line -->
                    <div class="gov-connector">
                        <div class="connector-line-v"></div>
                        <span class="connector-label">Policies & Standards</span>
                    </div>

                    <!-- Data Stewardship Layer -->
                    <div class="gov-tier stewards-tier">
                        <div class="tier-header">
                            <i class="fas fa-user-shield"></i>
                            <span>DATA STEWARDSHIP</span>
                        </div>
                        <div class="stewards-grid">
                            <div class="steward-domain">
                                <div class="domain-header sales">
                                    <i class="fas fa-chart-line"></i>
                                    <span>Sales Domain</span>
                                </div>
                                <div class="steward-card">
                                    <span class="steward-title">Data Steward</span>
                                    <span class="steward-name">Business Owner</span>
                                    <div class="steward-tasks">
                                        <span><i class="fas fa-check"></i> Define data definitions</span>
                                        <span><i class="fas fa-check"></i> Approve access requests</span>
                                    </div>
                                </div>
                            </div>
                            <div class="steward-domain">
                                <div class="domain-header finance">
                                    <i class="fas fa-dollar-sign"></i>
                                    <span>Finance Domain</span>
                                </div>
                                <div class="steward-card">
                                    <span class="steward-title">Data Steward</span>
                                    <span class="steward-name">Finance Lead</span>
                                    <div class="steward-tasks">
                                        <span><i class="fas fa-check"></i> Validate calculations</span>
                                        <span><i class="fas fa-check"></i> Audit compliance</span>
                                    </div>
                                </div>
                            </div>
                            <div class="steward-domain">
                                <div class="domain-header customer">
                                    <i class="fas fa-users"></i>
                                    <span>Customer Domain</span>
                                </div>
                                <div class="steward-card">
                                    <span class="steward-title">Data Steward</span>
                                    <span class="steward-name">CRM Manager</span>
                                    <div class="steward-tasks">
                                        <span><i class="fas fa-check"></i> PII classification</span>
                                        <span><i class="fas fa-check"></i> Consent management</span>
                                    </div>
                                </div>
                            </div>
                            <div class="steward-domain">
                                <div class="domain-header product">
                                    <i class="fas fa-box"></i>
                                    <span>Product Domain</span>
                                </div>
                                <div class="steward-card">
                                    <span class="steward-title">Data Steward</span>
                                    <span class="steward-name">Product Owner</span>
                                    <div class="steward-tasks">
                                        <span><i class="fas fa-check"></i> Schema ownership</span>
                                        <span><i class="fas fa-check"></i> Quality rules</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Connection Line -->
                    <div class="gov-connector">
                        <div class="connector-line-v"></div>
                        <span class="connector-label">Implementation</span>
                    </div>

                    <!-- Technical Implementation Layer -->
                    <div class="gov-tier technical-tier">
                        <div class="tier-header">
                            <i class="fas fa-cogs"></i>
                            <span>TECHNICAL IMPLEMENTATION</span>
                        </div>
                        <div class="tech-pillars">
                            <!-- Data Catalog -->
                            <div class="tech-pillar catalog">
                                <div class="pillar-icon">
                                    <i class="fas fa-book-open"></i>
                                </div>
                                <div class="pillar-content">
                                    <span class="pillar-title">Data Catalog</span>
                                    <div class="pillar-items">
                                        <span><i class="fas fa-search"></i> Discovery</span>
                                        <span><i class="fas fa-tags"></i> Metadata</span>
                                        <span><i class="fas fa-sitemap"></i> Lineage</span>
                                    </div>
                                    <div class="pillar-tools">
                                        <a href="https://atlan.com/" target="_blank">Atlan</a>
                                        <a href="https://datahubproject.io/" target="_blank">DataHub</a>
                                    </div>
                                </div>
                            </div>

                            <!-- Data Quality -->
                            <div class="tech-pillar quality">
                                <div class="pillar-icon">
                                    <i class="fas fa-check-double"></i>
                                </div>
                                <div class="pillar-content">
                                    <span class="pillar-title">Data Quality</span>
                                    <div class="pillar-items">
                                        <span><i class="fas fa-ruler"></i> Validation</span>
                                        <span><i class="fas fa-percentage"></i> Profiling</span>
                                        <span><i class="fas fa-bell"></i> Alerts</span>
                                    </div>
                                    <div class="pillar-tools">
                                        <a href="https://greatexpectations.io/" target="_blank">GX</a>
                                        <a href="https://www.soda.io/" target="_blank">Soda</a>
                                    </div>
                                </div>
                            </div>

                            <!-- Access Control -->
                            <div class="tech-pillar access">
                                <div class="pillar-icon">
                                    <i class="fas fa-lock"></i>
                                </div>
                                <div class="pillar-content">
                                    <span class="pillar-title">Access Control</span>
                                    <div class="pillar-items">
                                        <span><i class="fas fa-user-shield"></i> RBAC</span>
                                        <span><i class="fas fa-mask"></i> Masking</span>
                                        <span><i class="fas fa-key"></i> Encryption</span>
                                    </div>
                                    <div class="pillar-tools">
                                        <a href="https://immuta.com/" target="_blank">Immuta</a>
                                        <a href="https://privacera.com/" target="_blank">Privacera</a>
                                    </div>
                                </div>
                            </div>

                            <!-- Observability -->
                            <div class="tech-pillar observability">
                                <div class="pillar-icon">
                                    <i class="fas fa-eye"></i>
                                </div>
                                <div class="pillar-content">
                                    <span class="pillar-title">Observability</span>
                                    <div class="pillar-items">
                                        <span><i class="fas fa-heartbeat"></i> Health</span>
                                        <span><i class="fas fa-stream"></i> Freshness</span>
                                        <span><i class="fas fa-bug"></i> Anomalies</span>
                                    </div>
                                    <div class="pillar-tools">
                                        <a href="https://www.montecarlodata.com/" target="_blank">Monte Carlo</a>
                                        <a href="https://www.bigeye.com/" target="_blank">Bigeye</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- PII & Data Classification -->
                    <div class="gov-tier classification-tier">
                        <div class="tier-header">
                            <i class="fas fa-fingerprint"></i>
                            <span>DATA CLASSIFICATION & PII</span>
                        </div>
                        <div class="classification-grid">
                            <div class="class-level public">
                                <div class="class-badge">PUBLIC</div>
                                <div class="class-desc">General information, no restrictions</div>
                                <div class="class-examples">
                                    <span>Product names</span>
                                    <span>Public reports</span>
                                </div>
                            </div>
                            <div class="class-level internal">
                                <div class="class-badge">INTERNAL</div>
                                <div class="class-desc">Internal use only</div>
                                <div class="class-examples">
                                    <span>Sales metrics</span>
                                    <span>Operational data</span>
                                </div>
                            </div>
                            <div class="class-level confidential">
                                <div class="class-badge">CONFIDENTIAL</div>
                                <div class="class-desc">Restricted access, business sensitive</div>
                                <div class="class-examples">
                                    <span>Financial data</span>
                                    <span>Strategy docs</span>
                                </div>
                            </div>
                            <div class="class-level pii">
                                <div class="class-badge">PII / SENSITIVE</div>
                                <div class="class-desc">Personal data, requires masking</div>
                                <div class="class-examples">
                                    <span>Email, SSN</span>
                                    <span>Credit cards</span>
                                </div>
                                <div class="pii-actions">
                                    <span class="pii-action"><i class="fas fa-mask"></i> Masked</span>
                                    <span class="pii-action"><i class="fas fa-key"></i> Encrypted</span>
                                    <span class="pii-action"><i class="fas fa-clock"></i> Retention</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Governance Metrics Footer -->
                <div class="diagram-footer governance-footer">
                    <div class="gov-metrics">
                        <div class="gov-metric">
                            <span class="metric-value">98.5%</span>
                            <span class="metric-label">Data Quality Score</span>
                        </div>
                        <div class="gov-metric">
                            <span class="metric-value">156</span>
                            <span class="metric-label">Catalogued Assets</span>
                        </div>
                        <div class="gov-metric">
                            <span class="metric-value">100%</span>
                            <span class="metric-label">PII Compliant</span>
                        </div>
                        <div class="gov-metric">
                            <span class="metric-value">4</span>
                            <span class="metric-label">Data Domains</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    // Pipeline Mode Switcher
    function switchPipelineMode(mode: string) {
        // Update buttons
        document.querySelectorAll('.mode-btn').forEach(btn => {
            btn.classList.remove('active');
            if ((btn as HTMLElement).dataset.mode === mode) {
                btn.classList.add('active');
            }
        });

        // Update pipeline views
        document.querySelectorAll('.pipeline-mode').forEach(pipeline => {
            pipeline.classList.remove('active');
        });

        const targetPipeline = document.getElementById(`pipeline-${mode}`);
        if (targetPipeline) {
            targetPipeline.classList.add('active');
        }
    }

    // Add event listeners
    document.getElementById('btn-realtime')?.addEventListener('click', () => switchPipelineMode('realtime'));
    document.getElementById('btn-batch')?.addEventListener('click', () => switchPipelineMode('batch'));
    document.getElementById('btn-architecture')?.addEventListener('click', () => switchPipelineMode('architecture'));
    document.getElementById('btn-governance')?.addEventListener('click', () => switchPipelineMode('governance'));
</script>
